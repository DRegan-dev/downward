{% extends 'base.html' %}

{% block content %}
<div class="journal-history-container">
    <h1>My Descent History</h1>

    <!-- Session Filters -->
    <div class="filters">
        <form class="filter-form" method="get">
            <select name="descent_type" class="filter-select">
                <option value="">All Descent Types</option>
                {% for type in descent_types %}
                <option value="{{ type.pk }}" {% if request.GET.descent_type == type.pk|stringformat:"s" %}selected{% endif %}>
                    {{ type.name }}
                </option>
                {% endfor %}
            </select>
            <button type="submit" class="filter-button">
                <i class="fas fa-filter"></i> Filter
            </button>
        </form>
    </div>

    <!-- Session List -->
    <div class="session-list">
        {% for session in sessions %}
        <div class="session-card">
            <div class="session-header">
                <h3>{{ session.descent_type.name }}</h3>
                <p class="session-date">{{ session.started_At|date:"F j, Y" }}</p>
            </div>

            <div class="session-info">
                <p class="session-duration">
                    <i class="fas fa-clock"></i>
                    Duration: {{ session.completed_at|timesince:session.started_at }}
                </p>
                <p class="session-session">
                    <i class="fas {% if session.completed %}fa-check-circle text-success{% else %}fa-circle  text-warning{% endif %}"></i>
                    {% if session.completed %}Completed{% else %}In Progress{% endif %}
                </p>
            </div>

            <div class="session-actions">
                <a href="{% url 'session_detail' session.pk %}" class="action-button view">
                    <i class="fas fa-eye"></i> View 
                </a>
                {% if not session.completed %}
                <a href="{% url 'session_detail' session.pk %}" class="action-button continue">
                    <i class="fas fa-play"></i> Continue 
                </a>
                {% endif %}
            </div>
        </div>
        {% empty %}
        <p class="no-sessions">No descent sessions found.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}